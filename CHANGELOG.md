# 更新日志

## 版本 2.0 (当前版本)

### 主要改进

#### 技术升级
- ✅ **升级到 PyQt6**: 从 PyQt5 升级到 PyQt6，提高兼容性和性能
- ✅ **修复 linter 错误**: 解决了 `myWidget` 属性未知的问题
- ✅ **改进代码结构**: 使用全局变量管理窗口实例，避免在 mw 对象上添加属性

#### 功能完善
- ✅ **智能窗口管理**: 
  - 每次显示新卡片时自动弹出窗口
  - 窗口内容在卡片翻转时保持不变
  - 切换到新卡片时自动重置内容
- ✅ **独立窗口**: 草稿窗口作为独立窗口运行，不影响 Anki 主窗口
- ✅ **用户友好**: 窗口会自动置顶并激活

#### 代码质量
- ✅ **类型注解**: 添加了完整的类型注解
- ✅ **文档字符串**: 为所有方法添加了详细的中文文档
- ✅ **错误处理**: 改进了错误处理机制
- ✅ **代码组织**: 更好的代码结构和命名规范

### 文件变更

#### 新增文件
- `test_plugin.py`: 独立的测试脚本，用于验证插件功能
- `INSTALL.md`: 详细的安装说明文档
- `CHANGELOG.md`: 本更新日志文件

#### 修改文件
- `__init__.py`: 
  - 修复 linter 错误
  - 简化钩子注册逻辑
  - 使用全局变量管理窗口实例
- `DraftWindow.py`: 
  - 升级到 PyQt6
  - 添加完整的方法实现
  - 改进窗口管理逻辑
- `ui/ui_main.py`: 
  - 更新为 PyQt6 导入
  - 更新版本信息
- `README.md`: 
  - 完全重写，添加详细的功能说明
  - 包含安装和使用指南
- `meta.json`: 
  - 更新版本号到 2.0
  - 更新目标 Anki 版本

### 技术细节

#### 钩子系统
- 使用 `gui_hooks.reviewer_did_show_question` 钩子
- 在每次显示新卡片时触发窗口重置
- 确保窗口在卡片翻转时内容保持不变

#### 窗口管理
- 使用单例模式管理窗口实例
- 窗口作为独立窗口运行，支持置顶
- 智能显示/隐藏逻辑

#### UI 组件
- 基于 PyQt6 的现代化 UI
- 响应式布局
- 支持文本编辑和历史功能

### 兼容性

- **Anki 版本**: 2.5.0+
- **Python 版本**: 3.7+
- **操作系统**: Windows, macOS, Linux
- **UI 框架**: PyQt6

### 已知问题

- 无已知问题

### 未来计划

- [ ] 添加内容保存功能
- [ ] 支持快捷键操作
- [ ] 添加设置界面
- [ ] 支持多语言
- [ ] 添加主题支持

---

## 版本 1.0 (初始版本)

### 功能
- 基本的草稿窗口功能
- 基于 PyQt5 开发
- 简单的文本编辑功能

### 问题
- 存在 linter 错误
- 窗口管理逻辑不完善
- 缺少详细的文档 